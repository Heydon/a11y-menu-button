(function(global){"use strict";function MenuButton(button){this.button=button;this.button.setAttribute("aria-haspopup",true);this.button.setAttribute("aria-expanded",false);this.menuId=this.button.getAttribute("data-inclusive-menu-opens");this.menu=document.getElementById(this.menuId);if(!this.menu){throw new Error("#"+this.menuId+" menu missing")}this.menu.setAttribute("role","menu");this.menu.hidden=true;this.menuItems=this.menu.querySelectorAll("button");if(this.menuItems.length===0){throw new Error("The #"+this.menuId+" menu has no menu items")}this.firstItem=this.menuItems[0];this.lastItem=this.menuItems[this.menuItems.length-1];Array.prototype.forEach.call(this.menuItems,function(menuItem){menuItem.setAttribute("role","menuitem");menuItem.setAttribute("tabindex","-1");menuItem.addEventListener("keydown",function(e){var adjacent;if(e.keyCode===40){e.preventDefault();adjacent=menuItem.nextElementSibling||this.firstItem;adjacent.focus()}if(e.keyCode===38){e.preventDefault();adjacent=menuItem.previousElementSibling||this.lastItem;adjacent.focus()}if(e.keyCode===27||e.keyCode===9){this.toggle()}if(e.keyCode===27){e.preventDefault();this.button.focus()}}.bind(this));menuItem.addEventListener("click",function(e){this.select(menuItem);this.close();this.button.focus()}.bind(this))}.bind(this));this.button.addEventListener("click",function(){this.toggle()}.bind(this));this.button.addEventListener("keydown",function(e){if(e.keyCode===40){if(this.menu.hidden){this.toggle()}else{this.firstItem.focus()}}if(e.keyCode===38){this.close()}}.bind(this));this._listeners={}}MenuButton.prototype.open=function(){this.button.setAttribute("aria-expanded",true);this.menu.hidden=false;this.menuItems[0].focus();this._fire("open");return this};MenuButton.prototype.close=function(){this.button.setAttribute("aria-expanded",false);this.menu.hidden=true;this._fire("close");return this};MenuButton.prototype.toggle=function(){var expanded=this.button.getAttribute("aria-expanded")==="true";return expanded?this.close():this.open()};MenuButton.prototype.select=function(data){this._fire("choose",data);return this};MenuButton.prototype._fire=function(type,data){var listeners=this._listeners[type]||[];listeners.forEach(function(listener){listener(data)})};MenuButton.prototype.on=function(type,handler){if(typeof this._listeners[type]==="undefined"){this._listeners[type]=[]}this._listeners[type].push(handler);return this};if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=MenuButton}else if(typeof define==="function"&&define.amd){define("MenuButton",[],function(){return MenuButton})}else if(typeof global==="object"){global.MenuButton=MenuButton}})(this);